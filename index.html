<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GSD-Lite PRO | Fixed UI</title>
    <style>
        /* Ensure the body takes up the full screen */
        html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; background: #2b2b2b; }
        body { font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; }

        /* Absolute positioning for the toolbar to keep it ABOVE the canvas */
        .toolbar { 
            position: fixed; 
            top: 10px; 
            left: 10px; 
            display: flex; 
            flex-wrap: wrap; 
            gap: 6px; 
            z-index: 9999; /* Higher than anything else */
            background: rgba(43, 43, 43, 0.8); /* Slight background for contrast */
            padding: 5px;
            border-radius: 6px;
        }

        #canvas-container { 
            flex-grow: 1; 
            position: relative; 
            background: #ffffff; 
            width: 100vw;
        }

        canvas { position: absolute; top: 0; left: 0; display: block; }

        #terminal { 
            height: 100px; 
            background: #121212; 
            color: #00ff00; 
            padding: 12px; 
            font-family: 'Consolas', monospace; 
            overflow-y: auto; 
            border-top: 2px solid #444; 
            font-size: 13px; 
            z-index: 100;
        }

        #input-area { 
            background: #1e1e1e; 
            padding: 8px 15px; 
            display: flex; 
            align-items: center; 
            border-top: 1px solid #333; 
            z-index: 100;
        }

        input { flex-grow: 1; background: transparent; color: #fff; border: none; padding: 5px; font-family: 'Consolas', monospace; outline: none; font-size: 16px; }

        button { 
            background: #3c3c3c; color: white; border: 1px solid #555; 
            padding: 8px 12px; cursor: pointer; border-radius: 4px; 
            display: flex; align-items: center; gap: 6px; font-size: 10px; font-weight: bold;
        }
        button svg { width: 14px; height: 14px; fill: none; stroke: currentColor; stroke-width: 2.5; }
        button.active { background: #0078d4; border-color: #00aaff; }
        .label { color: #00aaff; font-weight: bold; margin-right: 10px; font-size: 12px; }
    </style>
</head>
<body>

<div class="toolbar">
    <button id="lineBtn"><svg viewBox="0 0 24 24"><line x1="3" y1="21" x2="21" y2="3"></line></svg> LINE</button>
    <button id="circleBtn"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="9"></circle></svg> CIRCLE</button>
    <button id="gridBtn" class="active"><svg viewBox="0 0 24 24"><path d="M3 3h18v18H3zM3 9h18M3 15h18M9 3v18M15 3v18"></path></svg> GRID</button>
    <button id="snapBtn"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="2" fill="currentColor"></circle><path d="M12 3v3m0 12v3M3 12h3m12 0h3"></path></svg> SNAP</button>
    <button id="endBtn"><svg viewBox="0 0 24 24"><rect x="4" y="4" width="16" height="16"></rect></svg> ENDPOINT</button>
    <button id="midBtn"><svg viewBox="0 0 24 24"><path d="M12 4l8 14H4z"></path></svg> MIDPOINT</button>
    <button id="clearBtn" style="color:#ff4444;"><svg viewBox="0 0 24 24"><path d="M18 6L6 18M6 6l12 12"></path></svg> CLEAR</button>
</div>

<div id="canvas-container">
    <canvas id="gridCanvas"></canvas>
    <canvas id="cadCanvas"></canvas>
</div>

<div id="terminal">GSD-Lite PRO Fixed UI. <br>Click the buttons above to test.</div>

<div id="input-area">
    <span class="label">COMMAND ></span>
    <input type="text" id="cmdInput" autofocus>
</div>

<script>
    // Include all the previous JavaScript logic here (Resize, drawGrid, redrawAll, etc.)
    // Make sure the resize function uses window.innerHeight minus the terminal/input height
    const cadCanvas = document.getElementById('cadCanvas');
    const gridCanvas = document.getElementById('gridCanvas');
    const ctx = cadCanvas.getContext('2d');
    const gCtx = gridCanvas.getContext('2d');

    let gridVisible = true, snapEnabled = false, endSnap = false, midSnap = false;
    let gridSpacing = 50, currentMode = null, points = [], drawings = [];

    function resize() {
        const terminalH = document.getElementById('terminal').offsetHeight;
        const inputH = document.getElementById('input-area').offsetHeight;
        cadCanvas.width = gridCanvas.width = window.innerWidth;
        cadCanvas.height = gridCanvas.height = window.innerHeight - (terminalH + inputH);
        drawGrid(); redrawAll();
    }
    window.addEventListener('resize', resize);

    // ... [Insert the rest of the drawing logic from the previous response here] ...
    
    // Quick Fix: Initial call to show buttons/grid immediately
    window.onload = resize;
</script>
</body>
</html>
